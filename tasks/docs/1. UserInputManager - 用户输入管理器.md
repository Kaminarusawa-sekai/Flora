åŸºäºå‰é¢æä¾›çš„DTOè®¾è®¡ï¼Œä¸ºäº†æœ‰æ•ˆç®¡ç†æ•´ä¸ªå¯¹è¯æµç¨‹ä¸­çš„å„ä¸ªç¯èŠ‚ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥ã€æ„å›¾è¯†åˆ«ã€è‰ç¨¿ç»´æŠ¤ã€ä»»åŠ¡æ‰§è¡Œç­‰ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦è®¾è®¡ä¸€ç³»åˆ—çš„ç®¡ç†å™¨ã€‚è¿™äº›ç®¡ç†å™¨å°†è´Ÿè´£å„è‡ªé¢†åŸŸçš„é€»è¾‘å¤„ç†å’ŒçŠ¶æ€ç»´æŠ¤ï¼Œä»¥ç¡®ä¿æ•´ä¸ªç³»ç»Ÿçš„é«˜æ•ˆè¿è¡Œã€‚ä¸‹é¢æ˜¯æ ¹æ®æµç¨‹è®¾è®¡çš„ä¸€äº›å…³é”®ç®¡ç†å™¨åŠå…¶èŒè´£æè¿°ï¼š

### 1. **UserInputManager - ç”¨æˆ·è¾“å…¥ç®¡ç†å™¨**

- èŒè´£

  ï¼š

  - æ¥æ”¶å¹¶è§£æç”¨æˆ·çš„åŸå§‹è¾“å…¥ï¼ˆé€šè¿‡ `UserInputDTO`ï¼‰ã€‚
  - è´Ÿè´£ä¼šè¯ç®¡ç†å’Œä¸Šä¸‹æ–‡è·Ÿè¸ªã€‚
  - å°†è§£æåçš„æ•°æ®ä¼ é€’ç»™æ„å›¾è¯†åˆ«ç®¡ç†å™¨ã€‚

### 2. **IntentRecognitionManager - æ„å›¾è¯†åˆ«ç®¡ç†å™¨**

- èŒè´£

  ï¼š

  - ä½¿ç”¨è‡ªç„¶è¯­è¨€ç†è§£æŠ€æœ¯åˆ†æç”¨æˆ·è¾“å…¥ï¼Œç¡®å®šç”¨æˆ·çš„æ„å›¾ï¼ˆç”Ÿæˆ `IntentRecognitionResultDTO`ï¼‰ã€‚
  - æå–å®ä½“ä¿¡æ¯ï¼Œå¹¶å°è¯•å¡«å……åˆ°å½“å‰ä»»åŠ¡æˆ–è‰ç¨¿ä¸­ã€‚
  - æ ¹æ®æ„å›¾ç±»å‹å†³å®šä¸‹ä¸€æ­¥åŠ¨ä½œï¼ˆåˆ›å»ºæ–°ä»»åŠ¡è‰ç¨¿ã€ä¿®æ”¹ç°æœ‰è‰ç¨¿ã€ç›´æ¥æ‰§è¡Œä»»åŠ¡ç­‰ï¼‰ã€‚

### 3. **TaskDraftManager - ä»»åŠ¡è‰ç¨¿ç®¡ç†å™¨**

- èŒè´£

  ï¼š

  - ç»´æŠ¤æ‰€æœ‰æœªå®Œæˆçš„ä»»åŠ¡è‰ç¨¿ï¼ˆ`TaskDraftDTO`ï¼‰ï¼ŒåŒ…æ‹¬åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤æ“ä½œã€‚
  - ç®¡ç†å¤šè½®å¯¹è¯ä¸­çš„å¡«æ§½è¿‡ç¨‹ï¼Œè¿½è¸ªå“ªäº›å¿…å¡«å­—æ®µå·²å¡«å†™ï¼Œå“ªäº›è¿˜éœ€è¦ç”¨æˆ·è¾“å…¥ã€‚
  - åœ¨ç”¨æˆ·ç¡®è®¤åï¼Œå‡†å¤‡ä»»åŠ¡æ‰§è¡Œæ‰€éœ€çš„æ‰€æœ‰å‚æ•°ã€‚

### 4. **TaskExecutionManager - ä»»åŠ¡æ‰§è¡Œç®¡ç†å™¨**

- èŒè´£

  ï¼š

  - è´Ÿè´£æ¥æ”¶ä»è‰ç¨¿ç®¡ç†å™¨æäº¤çš„ä»»åŠ¡ï¼Œå¯åŠ¨å®é™…çš„ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ï¼ˆä½¿ç”¨ `TaskExecutionContextDTO`ï¼‰ã€‚
  - ç›‘æ§ä»»åŠ¡æ‰§è¡Œè¿›åº¦ï¼Œå¤„ç†å¯èƒ½å‘ç”Ÿçš„ä¸­æ–­æƒ…å†µï¼ˆå¦‚éœ€è¦éªŒè¯ç ï¼‰ã€‚
  - è®°å½•æ‰§è¡Œæ—¥å¿—ï¼Œæä¾›ä»»åŠ¡çŠ¶æ€åé¦ˆç»™å‰ç«¯æˆ–å…¶ä»–æœåŠ¡ã€‚

### 5. **DialogStateManager - å¯¹è¯çŠ¶æ€ç®¡ç†å™¨**

- èŒè´£

  ï¼š

  - ç»´æŠ¤å…¨å±€å¯¹è¯çŠ¶æ€ï¼ˆ`DialogStateDTO`ï¼‰ï¼ŒåŒ…æ‹¬å½“å‰ä¼šè¯çš„æ„å›¾ã€æ´»è·ƒä»»åŠ¡ã€å†å²è®°å½•ç­‰ã€‚
  - æ”¯æŒä¸Šä¸‹æ–‡è®°å¿†åŠŸèƒ½ï¼Œä»¥ä¾¿åœ¨å¤šè½®å¯¹è¯ä¸­æ­£ç¡®ç†è§£å’Œå“åº”ç”¨æˆ·è¯·æ±‚ã€‚
  - ç®¡ç†ä¼šè¯ç”Ÿå‘½å‘¨æœŸï¼Œé€‚æ—¶æ¸…ç†è¿‡æœŸæˆ–æ— ç”¨çš„çŠ¶æ€æ•°æ®ã€‚

### 6. **SystemResponseManager - ç³»ç»Ÿå“åº”ç®¡ç†å™¨**

- èŒè´£

  ï¼š

  - æ ¹æ®å„ä¸ªç®¡ç†å™¨çš„ç»“æœç»„è£…ç³»ç»Ÿå›å¤ï¼ˆ`SystemResponseDTO`ï¼‰ï¼Œç¡®ä¿å¯¹ç”¨æˆ·è¾“å…¥åšå‡ºé€‚å½“å›åº”ã€‚
  - å†³å®šæ˜¯å¦æ˜¾ç¤ºå»ºè®®æ“ä½œï¼ˆå¿«æ·æŒ‰é’®ï¼‰ã€ç»“æ„åŒ–æ•°æ®æ˜¾ç¤ºï¼ˆå¡ç‰‡ï¼‰ç­‰å¢å¼ºäº¤äº’ä½“éªŒçš„å†…å®¹ã€‚
  - å¤„ç†å¼‚å¸¸æƒ…å†µï¼Œæä¾›å‹å¥½çš„é”™è¯¯æ¶ˆæ¯æˆ–é‡è¯•é€‰é¡¹ã€‚

### é¢å¤–è€ƒè™‘

- **å®‰å…¨ç®¡ç†å™¨**ï¼šå¦‚æœæ¶‰åŠåˆ°æ•æ„Ÿæ•°æ®å¤„ç†æˆ–æ“ä½œæƒé™æ§åˆ¶ï¼Œåˆ™éœ€è¦é¢å¤–çš„å®‰å…¨ç®¡ç†å™¨æ¥éªŒè¯ç”¨æˆ·èº«ä»½å’Œæˆæƒã€‚
- **å¼‚æ­¥äº‹ä»¶å¤„ç†å™¨**ï¼šå¯¹äºé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡æˆ–å¤–éƒ¨APIè°ƒç”¨ç»“æœï¼Œå¯ä»¥è®¾ç½®ä¸“é—¨çš„å¼‚æ­¥äº‹ä»¶å¤„ç†å™¨æ¥ç›‘å¬å¹¶å¤„ç†è¿™äº›äº‹ä»¶ï¼Œç„¶åæ›´æ–°ç›¸åº”ä»»åŠ¡çš„çŠ¶æ€ã€‚

è¿™ç§åˆ†å±‚æ¶æ„æœ‰åŠ©äºæ¸…æ™°åœ°åˆ’åˆ†è´£ä»»ï¼Œç®€åŒ–æ¯ä¸ªç»„ä»¶çš„è®¾è®¡ä¸å®ç°ï¼ŒåŒæ—¶ä¹Ÿä¾¿äºæœªæ¥çš„æ‰©å±•å’Œç»´æŠ¤ã€‚æ¯ç§ç®¡ç†å™¨éƒ½å¯ä»¥ä½œä¸ºç‹¬ç«‹çš„æœåŠ¡éƒ¨ç½²ï¼Œåˆ©ç”¨å¾®æœåŠ¡æ¶æ„çš„ä¼˜åŠ¿è¿›è¡Œçµæ´»ç»„åˆå’Œæ‰©å±•ã€‚





éå¸¸å¥½çš„é—®é¢˜ï¼ä½ æåˆ°çš„è¿™äº›åŠŸèƒ½ï¼ˆ**ä»»åŠ¡æŸ¥è¯¢ã€æ§åˆ¶ï¼ˆå–æ¶ˆ/æš‚åœï¼‰ã€å¾ªç¯ä»»åŠ¡ã€å®šæ—¶ä»»åŠ¡**ï¼‰å±äºä»»åŠ¡ç”Ÿå‘½å‘¨æœŸç®¡ç†çš„**é«˜çº§èƒ½åŠ›**ï¼Œå®ƒä»¬åœ¨åŸºç¡€æµç¨‹ä¹‹ä¸Šæ‰©å±•äº†ä»»åŠ¡ç³»ç»Ÿçš„è¡¨è¾¾åŠ›å’Œå®ç”¨æ€§ã€‚æˆ‘ä»¬éœ€è¦åœ¨åŸæœ‰ç®¡ç†å™¨ä½“ç³»ä¸­**å¢å¼ºæˆ–æ–°å¢ç‰¹å®šç®¡ç†å™¨**ï¼Œå¹¶ä¸º `TaskDraftDTO` å’Œ `TaskExecutionContextDTO` è¡¥å……å­—æ®µã€‚

ä¸‹é¢æˆ‘å°†æŒ‰ **åŠŸèƒ½ç»´åº¦ + ç®¡ç†å™¨èŒè´£ + DTO æ‰©å±•** ä¸ºä½ ç³»ç»ŸåŒ–è®¾è®¡ï¼š

------

## âœ… ä¸€ã€æ ¸å¿ƒæ–°å¢/å¢å¼ºç®¡ç†å™¨

### 1. **TaskQueryManager â€”â€” ä»»åŠ¡æŸ¥è¯¢ç®¡ç†å™¨**

- èŒè´£

  ï¼š

  - æ¥æ”¶â€œæŸ¥è¯¢ç±»â€æ„å›¾ï¼ˆå¦‚â€œæˆ‘æœ‰å“ªäº›ä»»åŠ¡ï¼Ÿâ€ã€â€œæ˜¨å¤©åˆ›å»ºçš„ä»»åŠ¡å®Œæˆäº†å—ï¼Ÿâ€ï¼‰
  - æ ¹æ®ç”¨æˆ·è‡ªç„¶è¯­è¨€è§£ææŸ¥è¯¢æ¡ä»¶ï¼ˆæ—¶é—´èŒƒå›´ã€çŠ¶æ€ã€ç±»å‹ã€å…³é”®è¯ç­‰ï¼‰
  - è°ƒç”¨ä»»åŠ¡å­˜å‚¨å±‚ï¼Œè¿”å›åŒ¹é…çš„ä»»åŠ¡åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µ/æ’åºï¼‰
  - ç”Ÿæˆç»“æ„åŒ–å“åº”ï¼ˆå¦‚å¡ç‰‡åˆ—è¡¨ã€æ‘˜è¦ï¼‰

- **è¾“å…¥**ï¼š`IntentRecognitionResultDTO`ï¼ˆintent = QUERY_TASKï¼‰

- **è¾“å‡º**ï¼š`SystemResponseDTO.displayData`ï¼ˆå«ä»»åŠ¡åˆ—è¡¨ï¼‰

> âš ï¸ æ³¨æ„ï¼šéœ€ä¸ `DialogStateManager` åä½œï¼Œåˆ©ç”¨ä¸Šä¸‹æ–‡ï¼ˆå¦‚â€œé‚£ä¸ªä»»åŠ¡â€ï¼‰åšæŒ‡ä»£æ¶ˆè§£ã€‚

------

### 2. **TaskControlManager â€”â€” ä»»åŠ¡æ§åˆ¶ç®¡ç†å™¨**

- èŒè´£

  ï¼š

  - å¤„ç†å¯¹**å·²å­˜åœ¨ä»»åŠ¡**çš„æ“ä½œæŒ‡ä»¤ï¼š**å–æ¶ˆã€æš‚åœã€æ¢å¤ã€é‡è¯•ã€å¼ºåˆ¶ç»ˆæ­¢**
  - éªŒè¯æ“ä½œåˆæ³•æ€§ï¼ˆå¦‚ä¸èƒ½å–æ¶ˆå·²å®Œæˆä»»åŠ¡ï¼‰
  - å‘ `TaskExecutionManager` å‘é€æ§åˆ¶ä¿¡å·
  - æ›´æ–°ä»»åŠ¡çŠ¶æ€å¹¶é€šçŸ¥ç”¨æˆ·

- å…¸å‹æŒ‡ä»¤

  ï¼š

  - â€œå–æ¶ˆåˆšæ‰é‚£ä¸ªçˆ¬è™«ä»»åŠ¡â€
  - â€œæš‚åœæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡â€
  - â€œé‡è¯•å¤±è´¥çš„é‚£ä¸ªâ€

- ä¾èµ–

  ï¼š

  - `DialogStateManager`ï¼ˆå®šä½ç›®æ ‡ä»»åŠ¡ IDï¼‰
  - `TaskExecutionManager`ï¼ˆæ‰§è¡Œæ§åˆ¶åŠ¨ä½œï¼‰

------

### 3. **ScheduleManager â€”â€” å®šæ—¶/å¾ªç¯ä»»åŠ¡è°ƒåº¦ç®¡ç†å™¨**

- èŒè´£

  ï¼š

  - è§£æç”¨æˆ·å…³äº**å®šæ—¶**ï¼ˆâ€œæ¯å¤©9ç‚¹æ‰§è¡Œâ€ï¼‰æˆ–**å¾ªç¯**ï¼ˆâ€œæ¯2å°æ—¶è·‘ä¸€æ¬¡â€ï¼‰çš„æŒ‡ä»¤
  - åœ¨è‰ç¨¿é˜¶æ®µè¯†åˆ«è°ƒåº¦æ„å›¾ï¼Œå¹¶å¡«å……è°ƒåº¦è§„åˆ™æ§½ä½
  - å°†è°ƒåº¦è§„åˆ™æŒä¹…åŒ–åˆ°ä»»åŠ¡å…ƒæ•°æ®ä¸­
  - ä¸åå°è°ƒåº¦å¼•æ“ï¼ˆå¦‚ Quartzã€Celeryã€Airflowï¼‰å¯¹æ¥ï¼Œæ³¨å†Œ/å–æ¶ˆè®¡åˆ’ä»»åŠ¡

- å…³é”®èƒ½åŠ›

  ï¼š

  - æ”¯æŒ cron è¡¨è¾¾å¼ã€è‡ªç„¶è¯­è¨€æ—¶é—´è§£æï¼ˆâ€œæ¯å‘¨ä¸€ä¸Šåˆâ€ï¼‰
  - ç®¡ç†è°ƒåº¦ä»»åŠ¡çš„å¯åœã€ä¿®æ”¹å‘¨æœŸ

> ğŸ’¡ æç¤ºï¼šè°ƒåº¦ä»»åŠ¡æœ¬è´¨æ˜¯â€œå¸¦è§¦å‘å™¨çš„æ™®é€šä»»åŠ¡â€ï¼Œæ‰§è¡Œé€»è¾‘ä»ç”± `TaskExecutionManager` è´Ÿè´£ã€‚

------

## âœ… äºŒã€DTO å­—æ®µæ‰©å±•

### ğŸ“ æ‰©å±• `TaskDraftDTO`

```ts
interface TaskDraftDTO {
  // ... åŸæœ‰å­—æ®µ ...

  // æ–°å¢ï¼šè°ƒåº¦ä¿¡æ¯ï¼ˆç”¨äºå®šæ—¶/å¾ªç¯ä»»åŠ¡ï¼‰
  schedule?: {
    type: 'ONCE' | 'RECURRING';       // ä¸€æ¬¡æ€§ or å¾ªç¯
    cronExpression?: string;          // æ ‡å‡† cronï¼ˆå¯é€‰ï¼‰
    naturalLanguage?: string;         // ç”¨æˆ·åŸå§‹è¯´æ³•ï¼šâ€œæ¯å¤©æ—©ä¸Š8ç‚¹â€
    nextTriggerTime?: number;         // ä¸‹æ¬¡è§¦å‘æ—¶é—´æˆ³
    timezone?: string;                // æ—¶åŒºï¼ˆå¦‚ "Asia/Shanghai"ï¼‰
    maxRuns?: number;                 // æœ€å¤§æ‰§è¡Œæ¬¡æ•°ï¼ˆå¾ªç¯ä»»åŠ¡ç”¨ï¼‰
    endTime?: number;                 // å¾ªç¯ç»“æŸæ—¶é—´
  };

  // æ–°å¢ï¼šä»»åŠ¡æ§åˆ¶å…ƒæ•°æ®
  isCancelable: boolean;              // æ˜¯å¦å…è®¸å–æ¶ˆï¼ˆé»˜è®¤ trueï¼‰
  isResumable: boolean;               // æ˜¯å¦æ”¯æŒæš‚åœ/æ¢å¤
}
```

------

### âš™ï¸ æ‰©å±• `TaskExecutionContextDTO`

```ts
interface TaskExecutionContextDTO {
  // ... åŸæœ‰å­—æ®µ ...

  // è°ƒåº¦ä¿¡æ¯ï¼ˆç»§æ‰¿è‡ªè‰ç¨¿ï¼‰
  schedule?: { /* åŒä¸Š */ };

  // æ§åˆ¶çŠ¶æ€
  controlStatus: 'NORMAL' | 'PAUSED' | 'CANCELLED_BY_USER' | 'TERMINATED';

  // å…³è”çš„çˆ¶ä»»åŠ¡ï¼ˆç”¨äºå¾ªç¯ä»»åŠ¡ï¼šæ¯æ¬¡æ‰§è¡Œæ˜¯ä¸€ä¸ªå­å®ä¾‹ï¼‰
  parentTaskId?: string;
  runIndex?: number;                  // ç¬¬å‡ æ¬¡è¿è¡Œï¼ˆå¾ªç¯ä»»åŠ¡ï¼‰

  // æŸ¥è¯¢ä¼˜åŒ–å­—æ®µ
  title: string;                      // ä»»åŠ¡æ ‡é¢˜ï¼ˆä¾¿äºå±•ç¤ºï¼‰
  tags: string[];                     // æ ‡ç­¾ï¼ˆå¦‚ ["çˆ¬è™«", "æ—¥æŠ¥"]ï¼‰
  createdBy: string;                  // åˆ›å»ºè€… ID
}
```

------

### ğŸ¯ æ‰©å±• `IntentRecognitionResultDTO`

```ts
// æ„å›¾æšä¸¾æ–°å¢
type Intent =
  | 'CREATE_TASK'
  | 'MODIFY_TASK'
  | 'QUERY_TASK'
  | 'DELETE_TASK'
  | 'CANCEL_TASK'      // â† æ–°å¢
  | 'PAUSE_TASK'       // â† æ–°å¢
  | 'RESUME_TASK'      // â† æ–°å¢
  | 'RETRY_TASK'       // â† æ–°å¢
  | 'SET_SCHEDULE'     // â† æ–°å¢ï¼ˆè®¾ç½®å®šæ—¶ï¼‰
  | 'IDLE_CHAT'
  | 'RESUME_INTERRUPTED';
```

------

## âœ… ä¸‰ã€æ•´ä½“ç®¡ç†å™¨åä½œæµç¨‹ï¼ˆæ–‡å­—ç‰ˆï¼‰

```
[ç”¨æˆ·è¯´ï¼šâ€œå–æ¶ˆæ˜¨å¤©é‚£ä¸ªçˆ¬è™«ä»»åŠ¡â€]
        â†“
UserInputManager â†’ IntentRecognitionManager
        â†“
è¯†åˆ«å‡º intent = CANCEL_TASKï¼Œentity: time="æ˜¨å¤©", taskType="çˆ¬è™«"
        â†“
DialogStateManager â†’ æŸ¥æ‰¾ recentTasks ä¸­åŒ¹é…çš„ä»»åŠ¡ â†’ å¾—åˆ° taskId=abc123
        â†“
TaskControlManager â†’ éªŒè¯ abc123 å¯å–æ¶ˆ â†’ è°ƒç”¨ TaskExecutionManager.cancel(abc123)
        â†“
TaskExecutionManager â†’ æ›´æ–° executionStatus = 'CANCELLED_BY_USER'
        â†“
SystemResponseManager â†’ ç”Ÿæˆå›å¤ï¼šâ€œå·²å–æ¶ˆæ˜¨å¤©çš„çˆ¬è™«ä»»åŠ¡ã€‚â€
[ç”¨æˆ·è¯´ï¼šâ€œæ¯å¤©æ—©ä¸Š8ç‚¹å¸®æˆ‘æŸ¥å¤©æ°”â€]
        â†“
IntentRecognitionManager â†’ CREATE_TASK + schedule.naturalLanguage="æ¯å¤©æ—©ä¸Š8ç‚¹"
        â†“
TaskDraftManager â†’ è§£ææ—¶é—´ â†’ ç”Ÿæˆ cron="0 8 * * *" â†’ å¡«å…¥ draft.schedule
        â†“
ç”¨æˆ·ç¡®è®¤å â†’ TaskExecutionManager æäº¤ä»»åŠ¡
        â†“
ScheduleManager â†’ æ³¨å†Œè¯¥ä»»åŠ¡åˆ°è°ƒåº¦å¼•æ“ï¼ˆä¸‹æ¬¡ 8:00 è§¦å‘ï¼‰
        â†“
åç»­æ¯å¤© 8:00 â†’ è°ƒåº¦å¼•æ“è°ƒç”¨ TaskExecutionManager.execute(taskId)
```

------

## âœ… å››ã€å»ºè®®çš„ç³»ç»Ÿæ¶æ„å›¾ï¼ˆæ¨¡å—å…³ç³»ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UserInputManager â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ IntentRecognitionMgr â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DialogStateManager   â”‚â†â”€â”€â†’â”‚ TaskStorage (DB)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
   â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
   â†“           â†“
TaskDraftMgr  TaskQueryMgr   â† å¤„ç†æ–°å»º/ä¿®æ”¹ vs æŸ¥è¯¢
   â†“           â†“
TaskControlMgr â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å¤„ç†å–æ¶ˆ/æš‚åœç­‰
   â†“
ScheduleManager             â† è§£æ & æ³¨å†Œå®šæ—¶è§„åˆ™
   â†“
TaskExecutionManager        â† å®é™…æ‰§è¡Œ + ä¸­æ–­å¤„ç† + çŠ¶æ€æ›´æ–°
   â†“
SystemResponseManager       â† ç»Ÿä¸€è¾“å‡º
```

------

## âœ… äº”ã€é¢å¤–å»ºè®®

- **ä»»åŠ¡å­˜å‚¨å±‚**ï¼šéœ€è¦æ”¯æŒæŒ‰ `status`, `type`, `createdAt`, `schedule.nextTriggerTime` ç­‰å­—æ®µé«˜æ•ˆæŸ¥è¯¢ã€‚
- **æƒé™æ§åˆ¶**ï¼šåœ¨ `TaskControlManager` ä¸­åŠ å…¥ç”¨æˆ·-ä»»åŠ¡å½’å±æ ¡éªŒã€‚
- **å¾ªç¯ä»»åŠ¡å»é‡**ï¼šé¿å…ç”¨æˆ·é‡å¤åˆ›å»ºç›¸åŒè°ƒåº¦ä»»åŠ¡ï¼ˆå¯é€šè¿‡å“ˆå¸Œä»»åŠ¡å‚æ•°+è°ƒåº¦è§„åˆ™åˆ¤æ–­ï¼‰ã€‚

------

å¦‚æœä½ å¸Œæœ›ï¼Œæˆ‘å¯ä»¥è¿›ä¸€æ­¥æä¾›ï¼š

- æ¯ä¸ªç®¡ç†å™¨çš„ä¼ªä»£ç æ¥å£å®šä¹‰ï¼ˆå¦‚ `TaskControlManager.cancel(taskId, userId)`ï¼‰
- ä»»åŠ¡çŠ¶æ€æœºçš„çŠ¶æ€è½¬æ¢å›¾ï¼ˆå« PAUSED / CANCELLED / SCHEDULED ç­‰ï¼‰
- å®šæ—¶ä»»åŠ¡çš„ cron è§£æç­–ç•¥ï¼ˆè‡ªç„¶è¯­è¨€ â†’ cronï¼‰

æ˜¯å¦éœ€è¦ï¼Ÿ